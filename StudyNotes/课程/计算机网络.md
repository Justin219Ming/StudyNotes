# 计算机网络

## 序章



## 物理层

### 宽带

FFC定义下行速率25M 上行速率3M

###　ADSL技术

非对称数字用户线ADSL

- 非对称 下行带宽远大于上行
- 把0~4kHz留给传统电话 高频段用于上网
- ADSL用了频分复用的方式 分频段来区分
- ADSL最大好处可以利用现有电话网的用户线，不需要重新布线

ADSL不适用于企业，企业需要大量的上行信道，需要发送大量数据给用户

（xDSL 很多不同的DSL 解决不同的问题）

### 2.6.2 光纤同轴混合网（HFC网）

主道用光纤，用户道用同轴（铜）电缆

- 机顶盒
- 电缆调制解调器

### 2.6.3 FTTx技术

代表多种宽带光纤接入方式

FTTH （Home） 光纤到户

光配线网ODN

多个用户共用一条光纤干线 进行传输和接受数据（到不同用户的时候会分开）

### 码分复用

- A * A  = +1
- A * A' = -1
- A * T  =  0
- A * T' =  0

当A站想要发送比特1 那么他就发送A的正交内积结果为1的序列

想要发送比特0 那么他就发送A的正交内积结果为-1的序列

什么都不发送 就是T  与A的正交内积结果为0

**正交内积就是按顺序一个一个相乘再相加起来 最后除以8**

## 数据链路层

网络中的主机、路由器等都必须实现数据链路层

- 交换机 物理层 和 数据链路层

- 路由器 物理层 数据链路层 网络层（拿到IP地址 找到对应出口）

### 数据链路层信道类型

- 点对点  一对一
- 广播通信 一对多 （需要定制好共享信道协议）

### 3.1.1 数据链路和帧

1. 链路 （物理链路）

2. 数据链路 （逻辑链路） = 控制协议的硬件+软件     典型实现：适配器（网卡）

#### 数据链路层协议数据单元：帧

来自网络层的IP数据报，在数据链路层封装（首尾都加上封装的数据）成为帧

### 3.1.2 三个基本问题

#### 封装成帧

在一段数据的前后分别添加首部和尾部，构成一个帧

最大传送单元MTU：能传送的帧的数据部分长度上限

帧定界符

用控制字符作为帧定界符 SOH EOT

#### 透明传输

透明指的是 忽略问题

举例 现在你的数据中有EOT的字符 但你没有想结束 导致数据错误

解决的方法是通过添加转义字符 比如说C中printf（“\n”） 中的\

#### 差错控制

循环冗余检验CRC

原始数据k位+n位冗余码    

事先约定好除数P n+1位

- 若相除之后余数=0 接受方接受

- 若余数!=0 接受方丢弃

用的是模2除法

不进位不退位

**CRC冗余码计算**

冗余码成为帧检验序列 FCS（不是只有CRC能得到FCS）

注意：无差错接受 （CRC还是有可能出现差错的 只是这个概率很小所以我们认为它没有出现差错）

使用CRC检验，我们认为实现了无比特差错

- 传输差错：帧丢失 帧重复 帧失序
- 比特差错

可靠传输：百分百一样

### PPP协议（数据链路层）

用户接入到ISP中 通过PPP协议

应满足的需求：

- 简单
- 封装成帧
- 透明性
- 等等

组成部分：

- 网络控制协议

- 链路控制协议

- 自动检测

PPP有一个2个字节的协议字段。其值

- 0x0021，则信息部分是IP数据报
- 0x8021，信息部分是网络控制数据
- 0xC021，信息部分是PPP链路控制数据

PPP长度是字节的整数倍

- 零比特填充 ： 在5个连续1后填入0

### 3.2.3 PPP协议的工作状态

PPP协议的状态图（补充）

### 3.3使用广播信道的数据链路层

静态划分信道：

- 频分复用
- 时分复用
- 波分复用
- 码分复用

### 适配器的作用（网卡）

进行串行并行转换

数据缓存

安装驱动程序

实现以太网的协议

### CSMA/CD 协议

当数据帧中的目的地址和适配器地址一样的时候，接受数据

- 多点接入： 多台计算机以多点接入连在一根总线上
- 载波监听： 一边发送一边监听
- 碰撞检测： 检测信号电压变化，电压摆动值超过一定阈值，认为发生碰撞

发生碰撞之后，会立刻停止发送，在之后的随机时间再重新发送

协议的工作流程（可以补充流程图） 

#### 碰撞检测

在发送完之后的2倍传播时延中，称为碰撞窗口

只有过了这段时间也没有检测到碰撞，可以认为没有发生碰撞

#### 碰撞后重传

截断二进制指数退避（动态退避）

1. 基本退避时间 2t
2. 从集合里面选一个数*2t  集合大小和重传次数有关 第一次为0,1 第二次为0,1,2,3 依次类推
3. 

#### 10Mbit/s以太网争用期长度

time=51.2μs

对于这种以太网来说，在争用期可以发送512bit，等于64字节

以太网规定最短有效帧长度为64字节

#### 以太网采取的措施：

- 灵活的无连接的工作方式
- 发送数据用曼彻斯特编码（缺点 占用的信道宽度？多了一倍）